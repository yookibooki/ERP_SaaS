#!/bin/sh
set -e

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

REGEX="^(feat|fix|docs|style|refactor|test|chore)(\([a-zA-Z0-9_-]+\))?: .+$"

if ! echo "$COMMIT_MSG" | grep -Eq "$REGEX"; then
  echo "Error: Commit message does not follow Conventional Commits format."
  echo "Format: <type>(<scope>): <description>"
  echo "Example: feat(auth): add user authentication"
  echo "Allowed types: feat, fix, docs, style, refactor, test, chore"
  echo "Current message: $COMMIT_MSG"
  exit 1
fi

echo "Commit message format is valid."
exit 0